{"version":3,"sources":["../../../app/services/database.js"],"names":["require","config","db","Database","useBasicAuth","process","env","ARANGODB_USERNAME","ARANDODB_PASSWORD","useDatabase","getUserById","userId","query","aql","cursor","next","result","Error","getAllUsers","all","createUser","user","deleteUser","updateUser","userContent","patchUser","deleteUserObject","module","exports"],"mappings":"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","file":"database.js","sourcesContent":["import { Database, aql } from 'arangojs';\n\nrequire('dotenv').config();\n\nconst db = new Database('http://localhost:8529');\ndb.useBasicAuth(process.env.ARANGODB_USERNAME, process.env.ARANDODB_PASSWORD);\n\ndb.useDatabase('Users');\n\n// Retrieve user by id\nconst getUserById = async (userId) => {\n  try {\n    const cursor = await db.query(aql`RETURN DOCUMENT(\"UserDetails\", ${userId})`);\n    const result = await cursor.next();\n    return result;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\n// Retrieve all users from db\nconst getAllUsers = async () => {\n  try {\n    const cursor = await db.query('FOR doc IN UserDetails RETURN doc');\n    const result = await cursor.all();\n    return result;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\n// Insert user into db\nconst createUser = async (user) => {\n  try {\n    const cursor = await db.query(aql`INSERT ${user} IN UserDetails RETURN NEW`);\n    return cursor;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\n// Delete user from DB\nconst deleteUser = async (userId) => {\n  try {\n    const cursor = await db.query(aql`UPDATE ${userId} WITH { deleted: true } IN UserDetails RETURN NEW`);\n    return cursor;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\nconst updateUser = async (userId, userContent) => {\n  try {\n    const cursor = await db.query(aql`REPLACE ${userId} WITH ${userContent} IN UserDetails RETURN NEW`);\n    return cursor;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\nconst patchUser = async (userId, userContent) => {\n  try {\n    const cursor = await db.query(aql`UPDATE ${userId} WITH ${userContent} IN UserDetails RETURN NEW`);\n    return cursor;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\n// Remove from db for test purposes\nconst deleteUserObject = async (userId) => {\n  try {\n    const cursor = await db.query(aql`REMOVE ${userId} IN UserDetail`);\n    return cursor;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\nmodule.exports = {\n  getAllUsers,\n  createUser,\n  getUserById,\n  deleteUser,\n  patchUser,\n  updateUser,\n  deleteUserObject,\n};\n\n"]}