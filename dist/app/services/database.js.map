{"version":3,"sources":["../../../app/services/database.js"],"names":["require","config","db","Database","useBasicAuth","process","env","ARANGODB_USERNAME","ARANDODB_PASSWORD","useDatabase","getUserById","userId","query","aql","params","userid","cursor","next","result","Error","getAllUsers","all","createUser","user","deleteUser","updateUser","request","body","patchUser","module","exports"],"mappings":"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","file":"database.js","sourcesContent":["import { Database, aql } from 'arangojs';\n\nrequire('dotenv').config();\n\nconst db = new Database('http://localhost:8529');\ndb.useBasicAuth(process.env.ARANGODB_USERNAME, process.env.ARANDODB_PASSWORD);\n\ndb.useDatabase('Users');\n\n// Retrieve user by id\nconst getUserById = async (userId) => {\n  try {\n    const cursor = await db.query(aql`RETURN DOCUMENT(\"UserDetails\", ${userId.params.userid})`);\n    const result = await cursor.next();\n    return result;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\n// Retrieve all users from db\nconst getAllUsers = async () => {\n  try {\n    const cursor = await db.query('FOR doc IN UserDetails RETURN doc');\n    const result = await cursor.all();\n    return result;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\n// Insert user into db\nconst createUser = async (user) => {\n  try {\n    const cursor = await db.query(aql`INSERT ${user} IN UserDetails RETURN NEW`);\n    return cursor;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\n// Delete user from DB\nconst deleteUser = async (userId) => {\n  try {\n    const cursor = await db.query(aql`UPDATE ${userId.params.userid} WITH { deleted: true } IN UserDetails RETURN NEW`);\n    return cursor;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\nconst updateUser = async (user) => {\n  try {\n    const cursor = await db.query(aql`REPLACE ${user.params.userid} WITH ${user.request.body} IN UserDetails RETURN NEW`);\n    return cursor;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\nconst patchUser = async (user) => {\n  try {\n    const cursor = await db.query(aql`UPDATE ${user.params.userid} WITH ${user.request.body} IN UserDetails RETURN NEW`);\n    return cursor;\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\nmodule.exports = {\n  getAllUsers,\n  createUser,\n  getUserById,\n  deleteUser,\n  patchUser,\n  updateUser,\n};\n\n"]}